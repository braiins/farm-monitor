{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": "-- Grafana --",
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "target": {
          "limit": 100,
          "matchAny": false,
          "tags": [],
          "type": "dashboard"
        },
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 0,
  "id": 13,
  "iteration": 1669988558738,
  "links": [],
  "liveNow": false,
  "panels": [
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 0
      },
      "id": 20,
      "panels": [],
      "title": "Overview",
      "type": "row"
    },
    {
      "description": "**Nominal hashrate**: based on manufacturer data \\\n**Real hashrate**: measured hashrate based on 1m average \\\n*Click on the graph to see list of all devices* \\\nnote: nominal hashrate is not available for Antminers S9 with BOS+",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-RdYlGr"
          },
          "displayName": "${__series.name}",
          "links": [
            {
              "targetBlank": true,
              "title": "List of miners",
              "url": "d/R1-4NFs7k/list-of-miners?$${queryparam}"
            }
          ],
          "mappings": [],
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "GHs"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Nominal HR"
            },
            "properties": [
              {
                "id": "displayName"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 4,
        "w": 9,
        "x": 0,
        "y": 1
      },
      "id": 4,
      "options": {
        "displayMode": "lcd",
        "orientation": "horizontal",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showUnfilled": true
      },
      "pluginVersion": "8.4.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "sum(hashboard_nominal_hashrate_ghs{job=~\"$OS\",label=~\"$label\"})",
          "instant": true,
          "interval": "",
          "legendFormat": "Nominal HR",
          "refId": "A"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "sum(\n  sum by (instance) (rate(hashboard_shares{job=~\"$OS\",label=~\"$label\"}[$interval]) * 2^32 / 1e9) or \n  sum by (instance) (rate(stratum_accepted_shares_counter{job=~\"$OS\",label=~\"$label\"}[$interval]) * 2^32 / 1e9) or \n  sum by (instance) (average_hashrate_last_5_sec_ghs{job=~\"$OS\",label=~\"$label\"})\n  )",
          "hide": false,
          "instant": true,
          "interval": "",
          "legendFormat": "Real HR (10s)",
          "refId": "B"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "sum(\n  sum by (instance) (rate(hashboard_shares{job=~\"$OS\",label=~\"$label\"}[$interval]) * 2^32 / 1e9) or \n  sum by (instance)  (rate(stratum_accepted_shares_counter{job=~\"$OS\",label=~\"$label\"}[$interval]) * 2^32 / 1e9) or \n  sum by (instance)  (average_hashrate_last_5_sec_ghs{job=~\"$OS\",label=~\"$label\"})\n  )\n/\nsum(hashboard_nominal_hashrate_ghs{job=~\"$OS\",label=~\"$label\"})",
          "hide": true,
          "instant": true,
          "interval": "",
          "legendFormat": "MCR",
          "refId": "C"
        }
      ],
      "title": "Hashrate",
      "type": "bargauge"
    },
    {
      "description": "**Discovered**: No. of discovered devices by the scanning procedure \\\n**Monitored**: No. of devices, which are *up* (~ miner is exposing any metric)\\\n**Mining**: No. of devices, which produced *some* hashrate in the last 5 minutes\\\n**Not Mining**: No. of devices, which produced *no* hashrate in the last 5 minutes \\\n**Offline**: No. of devices, which are *down* (~ miner is **not** exposing any metric)",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-BlPu"
          },
          "links": [
            {
              "targetBlank": true,
              "title": "List of not mining devices",
              "url": "d/zLpA9dsnk/drill-down-not-mining-instance?${OS:queryparam}﻿&﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿${label:queryparam}"
            },
            {
              "targetBlank": true,
              "title": "List of offline devices",
              "url": "d/GwQo-6S4k/drill-down-offline-instance?${OS:queryparam}﻿&﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿${label:queryparam}"
            }
          ],
          "mappings": [
            {
              "options": {
                "match": "null+nan",
                "result": {
                  "index": 0,
                  "text": "N/A"
                }
              },
              "type": "special"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Not Mining"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Offline"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 6,
        "w": 7,
        "x": 9,
        "y": 1
      },
      "id": 2,
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "value_and_name"
      },
      "pluginVersion": "8.4.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "count(up{job=~\"$OS\",label=~\"$label\",instance!=\"localhost:8081\"}) or vector(0)",
          "instant": true,
          "interval": "",
          "legendFormat": "Discovered",
          "refId": "A"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "count(up{job=~ \"$OS\",label=~\"$label\",instance!=\"localhost:8081\"} == 1) or vector(0)",
          "format": "time_series",
          "hide": false,
          "instant": true,
          "interval": "",
          "legendFormat": "Monitored",
          "refId": "B"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "count(sum by (instance) (rate(stratum_accepted_submits_counter{job=~\"$OS\",label=~\"$label\"}[$interval])) > 0 or \nsum by (instance) (rate(stratum_accepted_shares_counter{job=~\"$OS\",label=~\"$label\"}[$interval])) > 0 or \nsum by (instance) (average_hashrate_last_5_sec_ghs{job=~\"$OS\",label=~\"$label\"}) > 0)\nor vector(0)",
          "hide": false,
          "instant": true,
          "interval": "",
          "legendFormat": "Mining",
          "refId": "C"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "count(\n  max by (instance,job) (rate(stratum_accepted_submits_counter{job=~\"$OS\",label=~\"$label\",instance!=\"localhost:8081\"}[$interval]) or \n                         rate(stratum_accepted_shares_counter{job=~\"$OS\",label=~\"$label\",instance!=\"localhost:8081\"}[$interval]) or\n                         average_hashrate_last_5_sec_ghs{job=~\"$OS\",label=~\"$label\"} or\n                         up{job=~\"$OS\",label=~\"$label\",instance!=\"localhost:8081\"} - 1) == 0\n)",
          "hide": false,
          "instant": true,
          "interval": "",
          "legendFormat": "Not Mining",
          "refId": "D"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "count(up{job=~ \"$OS\",label=~\"$label\",instance!=\"localhost:8081\"} == 0) or vector(0)",
          "hide": false,
          "instant": true,
          "interval": "",
          "legendFormat": "Offline",
          "refId": "E"
        }
      ],
      "title": "Miner Recognition",
      "type": "stat"
    },
    {
      "description": "Links to the *Braiins* product webpages",
      "gridPos": {
        "h": 5,
        "w": 8,
        "x": 16,
        "y": 1
      },
      "id": 6,
      "options": {
        "content": "<table width=\"100%\" style:\" border: none !important; table-layout: fixed; \" id=\"bps-table\">\n<tr>\n<td style=\"text-align: center; padding: 10px 0; width:50%;\"><a href=\"https://braiins.com/os/plus?utm_source=Grafana&utm_medium=Dashboard_panel\"  target=\"_blank\"><img src=\"https://design.braiins.com/assets/img/logos/braiins-os-plus-logo-reverse-rgb.svg?h=d35e19f3056bef1664b2c5cbde453a44\" height=\"25px\" align=\"center\"></a></td>\n<td style=\"text-align: center; padding: 10px 0; width:50%;\"><a href=\"https://braiins.com/pool\"  target=\"_blank\"><img src=\"https://braiins.visualbook.pro/assets/img/logos/braiins-pool-logo-reverse-rgb.svg\" height=\"25px\"></a></td>\n</tr>\n<tr>\n<td style=\"text-align: center; padding: 10px 0;\"><a href=\"https://stratumprotocol.org/?utm_source=Grafana&utm_medium=Dashboard_panel\"  target=\"_blank\" style=\"display:block\"><img src=\"https://design.braiins.com/assets/img/logos/stratum-v2-logo-reverse-rgb.svg?h=77e94750d6f57e33cf70c51e07e5aac5\" height=\"14px\"></a></td>\n<td style=\"text-align: center; padding: 10px 0;\"><a href=\"https://insights.braiins.com/?utm_source=Grafana&utm_medium=Dashboard_panel\"  target=\"_blank\" style=\"display:block\"><img src=\"https://design.braiins.com/assets/img/logos/braiins-insights-logo-on-dark-background-rgb.svg?h=aad9d059abab45e38f162e05c1fa322f\" height=\"17px\"></a></td>\n</tr>\n<tr>\n<td style=\"text-align: center; padding: 10px 0;\" colspan=\"2\"><a href=\"https://braiins.com/farm-proxy/?utm_source=Grafana&utm_medium=Dashboard_panel\"  target=\"_blank\" style=\"display:block\"><img src=\"https://design.braiins.com/assets/img/logos/farm-proxy-logo-white-rgb.svg?h=3e5188e1d46f58ccb0b910c6f8184b9b\" height=\"30px\"></a></td>\n</tr>\n</table>",
        "mode": "html"
      },
      "pluginVersion": "8.4.0",
      "title": "Braiins Products",
      "type": "text"
    },
    {
      "description": "**Measured to calculated ratio**: real hashrate / nominal hashrate \\\nnote: MCR not available for Antminers S9 with BOS+",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-RdYlGr"
          },
          "links": [],
          "mappings": [],
          "max": 1,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "percentunit"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 2,
        "w": 9,
        "x": 0,
        "y": 5
      },
      "id": 150,
      "options": {
        "displayMode": "lcd",
        "orientation": "horizontal",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showUnfilled": true
      },
      "pluginVersion": "8.4.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "sum(hashboard_nominal_hashrate_ghs{job=~\"$OS\",label=~\"$label\"})",
          "hide": true,
          "instant": true,
          "interval": "",
          "legendFormat": "Nominal HR",
          "refId": "A"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "sum(\n  sum by (instance) (rate(hashboard_shares{job=~\"$OS\",label=~\"$label\"}[$interval]) * 2^32 / 1e9) or \n  sum by (instance) (rate(stratum_accepted_shares_counter{job=~\"$OS\",label=~\"$label\"}[$interval]) * 2^32 / 1e9) or \n  sum by (instance) (average_hashrate_last_5_sec_ghs{job=~\"$OS\",label=~\"$label\"})\n  )",
          "hide": true,
          "instant": true,
          "interval": "",
          "legendFormat": "Real HR (10s)",
          "refId": "B"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "sum (\n(sum by (instance) (rate(hashboard_shares{}[1m]) * 2^32 / 1e9) or\n sum by (instance) (rate(stratum_accepted_shares_counter{}[$interval]) * 2^32 / 1e9) or \n sum by (instance) (average_hashrate_last_5_sec_ghs{}))\n + on (instance) group_left()(sum by (instance)(hashboard_nominal_hashrate_ghs{})*0)\n)\n/sum(\n(sum by (instance) (rate(hashboard_shares{}[1m]) * 2^32 / 1e9) * 0 or\n sum by (instance) (rate(stratum_accepted_shares_counter{}[$interval]) * 2^32 / 1e9) * 0 or \n sum by (instance) (average_hashrate_last_5_sec_ghs{})) * 0\n + on (instance) group_left()(sum by (instance)(hashboard_nominal_hashrate_ghs{}))\n)",
          "hide": false,
          "instant": true,
          "interval": "",
          "legendFormat": "MCR",
          "refId": "C"
        }
      ],
      "title": "MCR",
      "type": "bargauge"
    },
    {
      "gridPos": {
        "h": 5,
        "w": 8,
        "x": 16,
        "y": 6
      },
      "id": 131,
      "options": {
        "content": "Farm Monitor guideline: [documentation](https://academy.braiins.com/en/farm-monitor/about)\n\n[Get support](https://help.braiins.com/en/support/tickets/new) from the Braiins team\n\n*Dashboard is interactive, most of the graphs redirect user to a detail after a click on the statistic/graph.*\n\nFarm Monitor displays only data from devices running on **BOS+** or **stock firmware** (Antminers X17 and X19). BOS+ exposes it's metrics on `ip-address:8081/metrics` and provides many more data then the stock firmware. Data from stock are pulled from cgminer API by **metrics-exporter** and then exposed on `host:8081/metrics` to be digested by Prometheus.",
        "mode": "markdown"
      },
      "pluginVersion": "8.4.0",
      "title": "TL;DR",
      "type": "text"
    },
    {
      "description": "Hashrate by FW Type: BOS+ vs. Stock FW",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-RdYlGr"
          },
          "displayName": "${__series.name}",
          "mappings": [
            {
              "options": {
                "match": "null+nan",
                "result": {
                  "index": 0,
                  "text": "N/A"
                }
              },
              "type": "special"
            }
          ],
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "semi-dark-purple",
                "value": null
              }
            ]
          },
          "unit": "GHs"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 9,
        "x": 0,
        "y": 7
      },
      "id": 133,
      "options": {
        "displayMode": "lcd",
        "orientation": "horizontal",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showUnfilled": true
      },
      "pluginVersion": "8.4.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "#sum by (job) (rate(hashboard_shares{job=~\"braiinsos-data|metrics-exporter\",label=~\"$label\"}[10s]) * 2^32 / 1e9 or average_hashrate_last_5_sec_ghs#{job=~\"braiinsos-data|metrics-exporter\",label=~\"$label\"})\n\nsum by (job) (\n  sum by (instance,job) (rate(hashboard_shares{job=~\"braiinsos-data|metrics-exporter\",label=~\"$label\"}[$interval]) * 2^32 / 1e9) or \n  sum by (instance,job) (rate(stratum_accepted_shares_counter{job=~\"braiinsos-data|metrics-exporter\",label=~\"$label\"}[1m]) * 2^32 / 1e9) or \n  sum by (instance,job) (average_hashrate_last_5_sec_ghs{job=~\"braiinsos-data|metrics-exporter\",label=~\"$label\"})\n  )",
          "instant": true,
          "interval": "",
          "legendFormat": "{{job}}",
          "refId": "A"
        }
      ],
      "title": "Hashrate by FW Type",
      "transformations": [
        {
          "id": "renameByRegex",
          "options": {
            "regex": "braiinsos-data",
            "renamePattern": "BOS+"
          }
        },
        {
          "id": "renameByRegex",
          "options": {
            "regex": "metrics-exporter",
            "renamePattern": "Stock FW"
          }
        }
      ],
      "type": "bargauge"
    },
    {
      "description": "Discovered miners by FW type: *BOS+* vs. *Stock FW*",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-BlPu"
          },
          "links": [
            {
              "targetBlank": true,
              "title": "",
              "url": "d/GouhRHNVk/drill-down-os-instance?&var-os_type=${__field.labels.job}"
            }
          ],
          "mappings": [
            {
              "options": {
                "match": "null+nan",
                "result": {
                  "index": 0,
                  "text": "N/A"
                }
              },
              "type": "special"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "semi-dark-purple",
                "value": null
              }
            ]
          },
          "unit": "locale"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 7,
        "x": 9,
        "y": 7
      },
      "id": 12,
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "vertical",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "value_and_name"
      },
      "pluginVersion": "8.4.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "#sum(metrics_exporter_discovered_devices{fw=~\"bos|stock\"}) by (fw)\ncount by (job) (up{job=~\"$OS\",label=~\"$label\",instance!=\"localhost:8081\"})",
          "instant": true,
          "interval": "",
          "legendFormat": "{{job}}",
          "refId": "A"
        }
      ],
      "title": "FW Type",
      "transformations": [
        {
          "id": "renameByRegex",
          "options": {
            "regex": "braiinsos-data",
            "renamePattern": "BOS+"
          }
        },
        {
          "id": "renameByRegex",
          "options": {
            "regex": "metrics-exporter",
            "renamePattern": "Stock FW"
          }
        }
      ],
      "type": "stat"
    },
    {
      "description": "Maximal temperature from the monitored miners (chip/hashboard sensor measure) \\\n\\\n*note: temperatures > 200 C are filtered out because such values are nonsense (but they can appear in Stock FW when the miner has problems with fan detection)*",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "decimals": 0,
          "mappings": [
            {
              "options": {
                "match": "null+nan",
                "result": {
                  "index": 0,
                  "text": "N/A"
                }
              },
              "type": "special"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "semi-dark-purple",
                "value": null
              },
              {
                "color": "orange",
                "value": 80
              },
              {
                "color": "dark-red",
                "value": 90
              }
            ]
          },
          "unit": "celsius"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 0,
        "y": 11
      },
      "id": 10,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": true,
          "expr": "max(temperature{location=\"chip\",job=~\"$OS\",label=~\"$label\"} < 200) or\nmax(hashboard_temperature{type=\"raw\",job=~\"$OS\",label=~\"$label\"} < 200)",
          "interval": "",
          "legendFormat": "",
          "refId": "A"
        }
      ],
      "title": "Maximal Temperature",
      "type": "stat"
    },
    {
      "description": "Average fan speed, available only for BOS+ devices.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "decimals": 0,
          "mappings": [
            {
              "options": {
                "match": "null+nan",
                "result": {
                  "index": 0,
                  "text": "N/A"
                }
              },
              "type": "special"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "semi-dark-purple",
                "value": null
              },
              {
                "color": "orange",
                "value": 80
              },
              {
                "color": "dark-red",
                "value": 90
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 4,
        "y": 11
      },
      "id": 14,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": true,
          "expr": "avg(fan_speed_control{job=\"braiinsos-data\",label=~\"$label\"})",
          "interval": "",
          "legendFormat": "",
          "refId": "A"
        }
      ],
      "title": "Average Fan % (only BOS+)",
      "type": "stat"
    },
    {
      "description": "Targeted power consumption of the farm (only BOS+)",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [
            {
              "options": {
                "match": "null+nan",
                "result": {
                  "index": 0,
                  "text": "N/A"
                }
              },
              "type": "special"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "semi-dark-purple",
                "value": null
              }
            ]
          },
          "unit": "watt"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 8,
        "y": 11
      },
      "id": 17,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "text": {},
        "textMode": "auto"
      },
      "pluginVersion": "8.4.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": true,
          "expr": "sum(miner_power_target_w{type=\"configured\",job=\"braiinsos-data\",label=~\"$label\"}) or sum(miner_power{type=\"limit\",job=\"braiinsos-data\",label=~\"$label\"})",
          "interval": "",
          "legendFormat": "",
          "refId": "A"
        }
      ],
      "title": "Farm Power Target (only BOS+)",
      "type": "stat"
    },
    {
      "description": "Estimated power consumption of the farm (only for BOS+ devices)",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [
            {
              "options": {
                "match": "null+nan",
                "result": {
                  "index": 0,
                  "text": "N/A"
                }
              },
              "type": "special"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "semi-dark-purple",
                "value": null
              }
            ]
          },
          "unit": "watt"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 3,
        "x": 12,
        "y": 11
      },
      "id": 18,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": true,
          "expr": "sum(miner_power_target_w{type=\"current\",job=\"braiinsos-data\",label=~\"$label\"}) or sum(miner_power{type=\"estimated\",job=\"braiinsos-data\",label=~\"$label\"})",
          "instant": false,
          "interval": "",
          "legendFormat": "Estimated Power",
          "refId": "A"
        }
      ],
      "title": "Farm Est. Power (only BOS+)",
      "type": "stat"
    },
    {
      "description": "Average efficiency as *Watt / THs* (only for BOS+ devices)",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [
            {
              "options": {
                "match": "null+nan",
                "result": {
                  "index": 0,
                  "text": "N/A"
                }
              },
              "type": "special"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "semi-dark-purple",
                "value": null
              }
            ]
          },
          "unit": "W / THs"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 3,
        "x": 15,
        "y": 11
      },
      "id": 167,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": true,
          "expr": "avg\n((((sum by (instance) (miner_power_target_w{type=\"current\",job=\"braiinsos-data\",label=~\"$label\"}) or sum by (instance) (miner_power{type=\"estimated\",job=\"braiinsos-data\",label=~\"$label\"})) / on (instance) group_left(model) (sum by (instance) (rate(hashboard_shares{job=\"braiinsos-data\",label=~\"$label\"}[$interval])) * 2^32 / 1e12)) + on (instance) group_left(model) (miner_metadata{job=\"braiinsos-data\",label=~\"$label\"})) < 1e12 or\n(((sum by (instance) (miner_power_target_w{type=\"current\",job=\"braiinsos-data\",label=~\"$label\"}) or sum by (instance) (miner_power{type=\"estimated\",job=\"braiinsos-data\",label=~\"$label\"})) / on (instance) group_left(model) (sum by (instance) (rate(stratum_accepted_shares_counter{job=\"braiinsos-data\",label=~\"$label\"}[$interval])) * 2^32 / 1e12)) + on (instance) group_left(model) (miner_metadata{job=\"braiinsos-data\",label=~\"$label\"})) < 1e12)",
          "instant": false,
          "interval": "",
          "legendFormat": "Estimated Power",
          "refId": "A"
        }
      ],
      "title": "Avg. Efficiency(only BOS+)",
      "type": "stat"
    },
    {
      "description": "Number of currently tuning devices (only for BOS+ devices)",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Go to list of currently autotuning devices",
              "url": "d/ixQBxdHVk/drill-down-tuning-instance?"
            }
          ],
          "mappings": [
            {
              "options": {
                "match": "null+nan",
                "result": {
                  "index": 0,
                  "text": "N/A"
                }
              },
              "type": "special"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "semi-dark-purple",
                "value": null
              }
            ]
          },
          "unit": "locale"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 3,
        "x": 18,
        "y": 11
      },
      "id": 153,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": true,
          "expr": "count(max by(instance) (tuner_stage{job=\"braiinsos-data\",label=~\"$label\"} == 2 or tuner_stage{job=\"braiinsos-data\",label=~\"$label\"} == 3))",
          "instant": false,
          "interval": "",
          "legendFormat": "Estimated Power",
          "refId": "A"
        }
      ],
      "title": "Autotuning In Progress (only BOS+)",
      "type": "stat"
    },
    {
      "description": "Number of devices with less than 3 hasboards hashing.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "links": [
            {
              "targetBlank": true,
              "title": "",
              "url": "d/rkP23dy7z/drill-down-less-than-3-hbs-instance?from=now-15m&to=now&"
            }
          ],
          "mappings": [
            {
              "options": {
                "match": "null+nan",
                "result": {
                  "index": 0,
                  "text": "N/A"
                }
              },
              "type": "special"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "dark-red",
                "value": null
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 3,
        "x": 21,
        "y": 11
      },
      "id": 53,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "count(count by(instance) (rate(hashboard_shares{type=\"valid\",job=\"braiinsos-data\",label=~\"$label\"}[$interval]) > 0) <3)",
          "instant": true,
          "interval": "",
          "legendFormat": "",
          "refId": "A"
        }
      ],
      "title": "Less Than 3 HBs (only BOS+)",
      "type": "stat"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 15
      },
      "id": 139,
      "panels": [],
      "title": "Hashrate",
      "type": "row"
    },
    {
      "description": "Real (valid) and nominal hashrate over time",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [
            {
              "options": {
                "match": "null+nan",
                "result": {
                  "index": 0,
                  "text": "N/A"
                }
              },
              "type": "special"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "GHs"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 9,
        "w": 24,
        "x": 0,
        "y": 16
      },
      "id": 34,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": true,
          "expr": "sum(\n  sum by (instance) (rate(hashboard_shares{job=~\"$OS\",label=~\"$label\"}[$interval]) * 2^32 / 1e9) or \n  sum by (instance) (rate(stratum_accepted_shares_counter{job=~\"$OS\",label=~\"$label\"}[$interval]) * 2^32 / 1e9) or \n  sum by (instance) (average_hashrate_last_5_sec_ghs{job=~\"$OS\",label=~\"$label\"})\n  )",
          "interval": "",
          "legendFormat": "Real Hashrate",
          "refId": "A"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": true,
          "expr": "sum(hashboard_nominal_hashrate_ghs{job=~\"$OS\",label=~\"$label\"})",
          "hide": false,
          "interval": "",
          "legendFormat": "Nominal Hashrate",
          "refId": "B"
        }
      ],
      "title": "Hashrate",
      "type": "timeseries"
    },
    {
      "description": "Hashrate by type (segmentation only for BOS+): \\\n*duplicate*: duplicate shares which are producing duplicate hashrate \\\n*invalid*: stales and other rejects are producing invalid hashrate \\\n*valid*: accepted shares producing valid hashrate",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [
            {
              "options": {
                "match": "null+nan",
                "result": {
                  "index": 0,
                  "text": "N/A"
                }
              },
              "type": "special"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "Hs"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "valid"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "dark-green",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "duplicate"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "dark-orange",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "invalid"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "dark-red",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 9,
        "w": 12,
        "x": 0,
        "y": 25
      },
      "id": 147,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": true,
          "expr": "sum by(type) (rate(hashboard_shares{job=\"braiinsos-data\",label=~\"$label\"}[$interval])) * 2^32",
          "interval": "",
          "legendFormat": "{{type}}",
          "refId": "A"
        }
      ],
      "title": "Hashrate by type (only BOS+)",
      "type": "timeseries"
    },
    {
      "description": "Miners with lowest MCR \\\nClick to the column to get redirected to the miner \\\n**Measured to calculated ratio**: real hashrate / nominal hashrate \\\nnote: MCR not available for Antminers S9 with BOS+",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-RdYlGr"
          },
          "decimals": 0,
          "displayName": "${__series.name}",
          "links": [
            {
              "targetBlank": true,
              "title": "Go to the miner",
              "url": "http://${__field.labels.instance}\n\n"
            }
          ],
          "mappings": [
            {
              "options": {
                "match": "null+nan",
                "result": {
                  "index": 0,
                  "text": "N/A"
                }
              },
              "type": "special"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "percentunit"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 9,
        "w": 12,
        "x": 12,
        "y": 25
      },
      "id": 30,
      "options": {
        "displayMode": "gradient",
        "orientation": "horizontal",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showUnfilled": true
      },
      "pluginVersion": "8.4.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "bottomk(10, \n    sort(\n        sum by (label,instance) (rate(hashboard_shares{job=~\"$OS\",label=~\"$label\"}[$interval]) * 2^32 / 1e9 or average_hashrate_last_5_sec_ghs{job=~\"$OS\",label=~\"$label\"})\n        /\n        sum by (label,instance) (hashboard_nominal_hashrate_ghs{job=~\"$OS\",label=~\"$label\"})\n    )\n)",
          "instant": true,
          "interval": "",
          "legendFormat": " {{label}}, {{instance}}",
          "refId": "A"
        }
      ],
      "title": "10 Miners with lowest MCR",
      "type": "bargauge"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 34
      },
      "id": 152,
      "panels": [],
      "title": "Miner Count",
      "type": "row"
    },
    {
      "description": "Number of miners sending data.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisLabel": "",
            "axisPlacement": "auto",
            "axisSoftMin": 0,
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 21,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 3,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "decimals": 0,
          "mappings": [
            {
              "options": {
                "match": "null+nan",
                "result": {
                  "index": 0,
                  "text": "N/A"
                }
              },
              "type": "special"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "semi-dark-purple",
                "value": null
              }
            ]
          },
          "unit": "locale"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 35
      },
      "id": 29,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "hidden",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": true,
          "expr": "count(count by (instance) (miner_metadata{job=~\"$OS\",label=~\"$label\"}))",
          "interval": "",
          "legendFormat": "",
          "refId": "A"
        }
      ],
      "title": "Running Miners",
      "type": "timeseries"
    },
    {
      "description": "Number of instances that are monitored (scraped by Prometheus) successfully (Up) or not (Down).",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 21,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 3,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Down"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Up"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "green",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 35
      },
      "id": 38,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "8.4.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": true,
          "expr": "count_values(\"Status\",up{job=~\"$OS\",label=~\"$label\"})",
          "interval": "",
          "legendFormat": "{{Status}}",
          "refId": "A"
        }
      ],
      "title": "Miner Health",
      "transformations": [
        {
          "id": "renameByRegex",
          "options": {
            "regex": "1",
            "renamePattern": "Up"
          }
        },
        {
          "id": "renameByRegex",
          "options": {
            "regex": "0",
            "renamePattern": "Down"
          }
        }
      ],
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 43
      },
      "id": 135,
      "panels": [],
      "title": "Temperature Control",
      "type": "row"
    },
    {
      "description": "At first, Maximum temperature is taken from each instance (miner).  Then Minimum, Average, and Maximum is calculated. \\\n\\\n*note: temperatures > 200 C are filtered out because such values are nonsense (but they can appear in Stock FW when the miner has problems with fan detection)*",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [
            {
              "options": {
                "match": "null+nan",
                "result": {
                  "index": 0,
                  "text": "N/A"
                }
              },
              "type": "special"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "celsius"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Max Temperature"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "dark-red",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Min Temperature"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "dark-green",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Avg Temperature"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "dark-blue",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 9,
        "w": 12,
        "x": 0,
        "y": 44
      },
      "id": 36,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": true,
          "expr": "avg(max by (instance) (temperature{job=~\"$OS\",label=~\"$label\"} < 200) or max by (instance) (hashboard_temperature{job=~\"$OS\",label=~\"$label\",type=\"raw\"} < 200))",
          "interval": "",
          "legendFormat": "Avg Temperature",
          "refId": "A"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": true,
          "expr": "max(max by (instance) (temperature{job=~\"$OS\",label=~\"$label\"} < 200) or max by (instance) (hashboard_temperature{job=~\"$OS\",label=~\"$label\",type=\"raw\"} < 200))",
          "hide": false,
          "interval": "",
          "legendFormat": "Max Temperature",
          "refId": "B"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": true,
          "expr": "min(max by (instance) (temperature{job=~\"$OS\",label=~\"$label\"} < 200) or max by (instance) (hashboard_temperature{job=~\"$OS\",label=~\"$label\",type=\"raw\"} < 200))",
          "hide": false,
          "interval": "",
          "legendFormat": "Min Temperature",
          "refId": "C"
        }
      ],
      "title": "Min, Avg, Max Temperature",
      "type": "timeseries"
    },
    {
      "description": "Top 10 instances by highest temperature. \\\n\\\n*note: temperatures > 200 C are filtered out because such values are nonsense (but they can appear in Stock FW when the miner has problems with fan detection)*",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-GrYlRd"
          },
          "decimals": 0,
          "displayName": "${__series.name}",
          "links": [
            {
              "targetBlank": true,
              "title": "Go to the miner",
              "url": "http://${__field.labels.instance}"
            }
          ],
          "mappings": [
            {
              "options": {
                "match": "null+nan",
                "result": {
                  "index": 0,
                  "text": "N/A"
                }
              },
              "type": "special"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "celsius"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 9,
        "w": 12,
        "x": 12,
        "y": 44
      },
      "id": 27,
      "options": {
        "displayMode": "gradient",
        "orientation": "horizontal",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showUnfilled": true
      },
      "pluginVersion": "8.4.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "topk(10,sort_desc(max by(label,instance) (temperature{job=~\"$OS\",label=~\"$label\"} < 200) or max by(label,instance) (hashboard_temperature{type=\"raw\",job=~\"$OS\",label=~\"$label\"} < 200)))",
          "instant": true,
          "interval": "",
          "legendFormat": " {{label}}, {{instance}}",
          "refId": "A"
        }
      ],
      "title": "Temperature Top 10 Instances",
      "type": "bargauge"
    },
    {
      "description": "Maximum fan speed is taken from each instance (miner).  Minimum, Average, and Maximum is then calculated.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [
            {
              "options": {
                "match": "null+nan",
                "result": {
                  "index": 0,
                  "text": "N/A"
                }
              },
              "type": "special"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Max Fan Speed"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "dark-red",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Min Fan Speed"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "dark-green",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Avg Fan Speed"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "dark-blue",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 53
      },
      "id": 40,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": true,
          "expr": "avg(max by (instance) (fan_speed_control{job=\"braiinsos-data\",label=~\"$label\"}))",
          "interval": "",
          "legendFormat": "Avg Fan Speed",
          "refId": "A"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": true,
          "expr": "max(max by (instance) (fan_speed_control{job=\"braiinsos-data\",label=~\"$label\"}))",
          "hide": false,
          "interval": "",
          "legendFormat": "Max Fan Speed",
          "refId": "B"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": true,
          "expr": "min(max by (instance) (fan_speed_control{job=\"braiinsos-data\",label=~\"$label\"}))",
          "hide": false,
          "interval": "",
          "legendFormat": "Min Fan Speed",
          "refId": "C"
        }
      ],
      "title": "Min, Avg, Max Fan Speed (only BOS+)",
      "type": "timeseries"
    },
    {
      "description": "Maximum RPM is taken from each instance (miner).  Minimum, Average, and Maximum is then calculated per each miner model.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "displayMode": "auto"
          },
          "decimals": 0,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "locale"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 53
      },
      "id": 169,
      "options": {
        "footer": {
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": []
      },
      "pluginVersion": "8.4.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "avg by (model) (max by (model,instance) (miner_metadata{job=~\"$OS\",label=~\"$label\"} + on (instance) group_right(model) fan_rpm_feedback{job=~\"$OS\",label=~\"$label\"}))",
          "format": "table",
          "instant": true,
          "interval": "",
          "legendFormat": "Avg Fan RPM",
          "refId": "A"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "max by (model) (max by (model,instance) (miner_metadata{job=~\"$OS\",label=~\"$label\"} + on (instance) group_right(model) fan_rpm_feedback{job=~\"$OS\",label=~\"$label\"}))",
          "format": "table",
          "hide": false,
          "instant": true,
          "interval": "",
          "legendFormat": "Max Fan RPM",
          "refId": "B"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "min by (model) (max by (model,instance) (miner_metadata{job=~\"$OS\",label=~\"$label\"} + on (instance) group_right(model) fan_rpm_feedback{job=~\"$OS\",label=~\"$label\"}))",
          "format": "table",
          "hide": false,
          "instant": true,
          "interval": "",
          "legendFormat": "Min Fan RPM",
          "refId": "C"
        }
      ],
      "title": "Min, Avg, Max Fan RPM",
      "transformations": [
        {
          "id": "seriesToColumns",
          "options": {
            "byField": "model"
          }
        },
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time 1": true,
              "Time 2": true,
              "Time 3": true,
              "Value #A": false
            },
            "indexByName": {
              "Time 1": 4,
              "Time 2": 5,
              "Time 3": 6,
              "Value #A": 1,
              "Value #B": 2,
              "Value #C": 3,
              "model": 0
            },
            "renameByName": {
              "Time 1": "Time",
              "Value": "Max RPM",
              "Value #A": "Avg Fan RPM",
              "Value #B": "Max Fan RPM",
              "Value #C": "Min Fan RPM",
              "model": "Model"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 61
      },
      "id": 141,
      "panels": [],
      "title": "Mining Pools",
      "type": "row"
    },
    {
      "description": "Active pool connections calculated as count over all miners",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-BlPu"
          },
          "displayName": "${__series.name}",
          "links": [
            {
              "targetBlank": true,
              "title": "",
              "url": "d/bflmpsvz/drill-down-active-pool-instance?var-host=${__series.name}"
            }
          ],
          "mappings": [
            {
              "options": {
                "match": "null+nan",
                "result": {
                  "index": 0,
                  "text": "N/A"
                }
              },
              "type": "special"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 7,
        "w": 12,
        "x": 0,
        "y": 62
      },
      "id": 25,
      "options": {
        "displayMode": "gradient",
        "orientation": "horizontal",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showUnfilled": true
      },
      "pluginVersion": "8.4.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "sort_desc(count_values('x',client_status{job=~\"$OS\",label=~\"$label\",connection_type=\"user\"} > 0) by (host))",
          "instant": true,
          "interval": "",
          "legendFormat": "{{host}}",
          "refId": "A"
        }
      ],
      "title": "Active Pools",
      "type": "bargauge"
    },
    {
      "description": "Dead pool connections calculated as count over all miners",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-BlPu"
          },
          "displayName": "${__series.name}",
          "links": [
            {
              "targetBlank": true,
              "title": "",
              "url": "d/HL10OOs7z/drill-down-dead-pool-instance?&var-host=${__field.labels.host}﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿"
            }
          ],
          "mappings": [
            {
              "options": {
                "match": "null+nan",
                "result": {
                  "index": 0,
                  "text": "N/A"
                }
              },
              "type": "special"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 7,
        "w": 12,
        "x": 12,
        "y": 62
      },
      "id": 24,
      "options": {
        "displayMode": "gradient",
        "orientation": "horizontal",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showUnfilled": true
      },
      "pluginVersion": "8.4.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "sort_desc(count_values('x',client_status{job=~\"$OS\",label=~\"$label\",connection_type=\"user\",host!=\"\"} < 0) by (host))",
          "instant": true,
          "interval": "",
          "legendFormat": "{{host}}",
          "refId": "A"
        }
      ],
      "title": "Dead Pools",
      "type": "bargauge"
    },
    {
      "description": "Pools URLs defined in the configuration of the individual miners, where no mining activity is detected.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [
            {
              "options": {
                "match": "null+nan",
                "result": {
                  "index": 0,
                  "text": "N/A"
                }
              },
              "type": "special"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 69
      },
      "id": 49,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": true,
          "expr": "count_values(\"Status\", client_status{job=~\"$OS\",label=~\"$label\"} < 0) by (host)",
          "interval": "",
          "legendFormat": "{{host}}",
          "refId": "A"
        }
      ],
      "title": "Dead Pools Over Time",
      "type": "timeseries"
    },
    {
      "description": "Number of active connections per mining protocol ~ SV1 vs. SV2.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-BlPu"
          },
          "displayName": "${__series.name}",
          "links": [
            {
              "targetBlank": true,
              "title": "Go to miners",
              "url": "d/g198TdN4k/drill-down-protocol-instance?&var-protocol=${__field.labels.protocol}"
            }
          ],
          "mappings": [
            {
              "options": {
                "match": "null+nan",
                "result": {
                  "index": 0,
                  "text": "N/A"
                }
              },
              "type": "special"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 69
      },
      "id": 149,
      "options": {
        "displayMode": "lcd",
        "orientation": "horizontal",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showUnfilled": true
      },
      "pluginVersion": "8.4.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "count by (protocol) (client_status{job=~\"$OS\",label=~\"$label\",connection_type=\"user\"} == 1)",
          "instant": true,
          "interval": "",
          "legendFormat": "{{protocol}}",
          "refId": "A"
        }
      ],
      "title": "Mining Protocol",
      "transformations": [
        {
          "id": "renameByRegex",
          "options": {
            "regex": ".[^+]*$",
            "renamePattern": ""
          }
        }
      ],
      "type": "bargauge"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 77
      },
      "id": 145,
      "panels": [],
      "title": "Miners",
      "type": "row"
    },
    {
      "description": "Model types of the miners",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-BlPu"
          },
          "displayName": "${__series.name}",
          "links": [
            {
              "targetBlank": true,
              "title": "",
              "url": "d/urEYt4I4k/drill-down-miner-model-instance?var-miner_model=${__series.name}﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿"
            }
          ],
          "mappings": [
            {
              "options": {
                "match": "null+nan",
                "result": {
                  "index": 0,
                  "text": "N/A"
                }
              },
              "type": "special"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 78
      },
      "id": 57,
      "options": {
        "displayMode": "lcd",
        "orientation": "horizontal",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showUnfilled": true
      },
      "pluginVersion": "8.4.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "sort_desc(count_values('x',miner_metadata{job=~\"$OS\",label=~\"$label\"}) by (model))",
          "instant": true,
          "interval": "",
          "legendFormat": "{{model}}",
          "refId": "A"
        }
      ],
      "title": "Miners count by model",
      "type": "bargauge"
    },
    {
      "description": "Version of the firmware \\\n*BOS+*: bos:{version} \\\n*Stock FW*: stock:{version}",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-BlPu"
          },
          "displayName": "${__series.name}",
          "links": [
            {
              "targetBlank": true,
              "title": "",
              "url": "d/uZT-Tds7z/drill-down-os-version-instance?var-os_version=${__field.labels.os_version}"
            }
          ],
          "mappings": [
            {
              "options": {
                "match": "null+nan",
                "result": {
                  "index": 0,
                  "text": "N/A"
                }
              },
              "type": "special"
            }
          ],
          "noValue": "N/A",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 78
      },
      "id": 55,
      "options": {
        "displayMode": "lcd",
        "orientation": "horizontal",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showUnfilled": true
      },
      "pluginVersion": "8.4.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "sort_desc(count by (os_version, job) (miner_metadata{job=~\"$OS\",label=~\"$label\"}))",
          "instant": true,
          "interval": "",
          "legendFormat": "{{job}},{{os_version}}",
          "refId": "A"
        }
      ],
      "title": "OS Version",
      "transformations": [
        {
          "id": "renameByRegex",
          "options": {
            "regex": "metrics-exporter",
            "renamePattern": "Stock FW"
          }
        },
        {
          "id": "renameByRegex",
          "options": {
            "regex": "braiinsos-data",
            "renamePattern": "BOS+"
          }
        }
      ],
      "type": "bargauge"
    },
    {
      "description": "Average hashrate by miner model",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-RdYlGr"
          },
          "displayName": "${__series.name}",
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "GHs"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 86
      },
      "id": 164,
      "options": {
        "displayMode": "basic",
        "orientation": "horizontal",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showUnfilled": true
      },
      "pluginVersion": "8.4.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "sort_desc(avg by (model) (\n    sum by (model,instance) (miner_metadata{job=~\"$OS\",label=~\"$label\"} + on(instance) group_right(model) rate(hashboard_shares{job=~\"$OS\",label=~\"$label\"}[$interval])) * 2^32 / 1e9 or\n    sum by (model,instance) (miner_metadata{job=~\"$OS\",label=~\"$label\"} + on(instance) group_right(model) rate(stratum_accepted_shares_counter{job=~\"$OS\",label=~\"$label\"}[1m])) * 2^32 / 1e9 or\n    sum by (model,instance) (miner_metadata{job=~\"$OS\",label=~\"$label\"} + on(instance) group_right(model) (average_hashrate_last_5_sec_ghs{job=~\"$OS\",label=~\"$label\"}))\n))",
          "instant": true,
          "interval": "",
          "legendFormat": "{{model}}",
          "refId": "A"
        }
      ],
      "title": "Average Hashrate By Model",
      "type": "bargauge"
    },
    {
      "description": "Average, min and max efficiency by each miner model. Available only for *BOS+*",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-GrYlRd"
          },
          "custom": {
            "align": "auto",
            "displayMode": "auto",
            "filterable": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "See instances my model and their efficiency",
              "url": "d/7ShdZZN4z/drill-down-miner-efficiency-instance?&var-miner_model=${__data.fields.Model}\n\n"
            }
          ],
          "mappings": [],
          "noValue": "-",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "W / THs"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 86
      },
      "id": 166,
      "options": {
        "footer": {
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": false,
            "displayName": "AvgEff"
          }
        ]
      },
      "pluginVersion": "8.4.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "min by (model)\n((((sum by (instance) (miner_power_target_w{type=\"current\"}) or sum by (instance) (miner_power{type=\"estimated\"})) / on (instance) group_left(model) (sum by (instance) (rate(hashboard_shares{}[$interval])) * 2^32 / 1e12)) + on (instance) group_left(model) (miner_metadata)) < 1e12 or\n(((sum by (instance) (miner_power_target_w{type=\"current\"}) or sum by (instance) (miner_power{type=\"estimated\"})) / on (instance) group_left(model) (sum by (instance) (rate(stratum_accepted_shares_counter{}[$interval])) * 2^32 / 1e12)) + on (instance) group_left(model) (miner_metadata)) < 1e12)",
          "format": "table",
          "instant": true,
          "interval": "",
          "legendFormat": "{{model}}",
          "refId": "MinEff"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "max by (model)\n((((sum by (instance) (miner_power_target_w{type=\"current\"}) or sum by (instance) (miner_power{type=\"estimated\"})) / on (instance) group_left(model) (sum by (instance) (rate(hashboard_shares{}[$interval])) * 2^32 / 1e12)) + on (instance) group_left(model) (miner_metadata)) < 1e12 or\n(((sum by (instance) (miner_power_target_w{type=\"current\"}) or sum by (instance) (miner_power{type=\"estimated\"})) / on (instance) group_left(model) (sum by (instance) (rate(stratum_accepted_shares_counter{}[$interval])) * 2^32 / 1e12)) + on (instance) group_left(model) (miner_metadata)) < 1e12)",
          "format": "table",
          "hide": false,
          "instant": true,
          "interval": "",
          "legendFormat": "{{model}}",
          "refId": "MaxEff"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "avg by (model)\n((((sum by (instance) (miner_power_target_w{type=\"current\"}) or sum by (instance) (miner_power{type=\"estimated\"})) / on (instance) group_left(model) (sum by (instance) (rate(hashboard_shares{}[$interval])) * 2^32 / 1e12)) + on (instance) group_left(model) (miner_metadata)) < 1e12 or\n(((sum by (instance) (miner_power_target_w{type=\"current\"}) or sum by (instance) (miner_power{type=\"estimated\"})) / on (instance) group_left(model) (sum by (instance) (rate(stratum_accepted_shares_counter{}[$interval])) * 2^32 / 1e12)) + on (instance) group_left(model) (miner_metadata)) < 1e12)",
          "format": "table",
          "hide": false,
          "instant": true,
          "interval": "",
          "legendFormat": "{{model}}",
          "refId": "AvgEff"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "count by (model)\n((((sum by (instance) (miner_power_target_w{type=\"current\"}) or sum by (instance) (miner_power{type=\"estimated\"})) / on (instance) group_left(model) (sum by (instance) (rate(hashboard_shares{}[$interval])) * 2^32 / 1e12)) + on (instance) group_left(model) (miner_metadata)) or\n(((sum by (instance) (miner_power_target_w{type=\"current\"}) or sum by (instance) (miner_power{type=\"estimated\"})) / on (instance) group_left(model) (sum by (instance) (rate(stratum_accepted_shares_counter{}[$interval])) * 2^32 / 1e12)) + on (instance) group_left(model) (miner_metadata)))",
          "hide": false,
          "instant": true,
          "interval": "",
          "legendFormat": "{{model}}",
          "refId": "Count"
        }
      ],
      "title": "Miner Efficiency (only BOS+)",
      "transformations": [
        {
          "id": "seriesToColumns",
          "options": {
            "byField": "model"
          }
        },
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time 1": true,
              "Time 2": true,
              "Time 3": true,
              "instance 1": true,
              "instance 2": true,
              "instance 3": true
            },
            "indexByName": {
              "Time 1": 4,
              "Time 2": 6,
              "Time 3": 8,
              "Value #AvgEff": 1,
              "Value #MaxEff": 3,
              "Value #MinEff": 2,
              "instance 1": 5,
              "instance 2": 7,
              "instance 3": 9,
              "model": 0
            },
            "renameByName": {
              "Time 1": "Time",
              "Value #AvgEff": "AvgEff",
              "Value #MaxEff": "MaxEff",
              "Value #MinEff": "MinEff",
              "instance 1": "",
              "model": "Model"
            }
          }
        },
        {
          "id": "sortBy",
          "options": {
            "fields": {},
            "sort": [
              {
                "field": "AvgEff"
              }
            ]
          }
        }
      ],
      "type": "table"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 94
      },
      "id": 32,
      "panels": [],
      "title": "Power Target (only BOS+)",
      "type": "row"
    },
    {
      "description": "Power target is taken from each instance (miner).  Minimum, Average, and Maximum is then calculated (BOS+ only)",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [
            {
              "options": {
                "match": "null+nan",
                "result": {
                  "index": 0,
                  "text": "N/A"
                }
              },
              "type": "special"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "watt"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Max Temperature"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "dark-red",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Min Temperature"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "dark-green",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Avg Temperature"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "dark-blue",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 7,
        "w": 12,
        "x": 0,
        "y": 95
      },
      "id": 45,
      "links": [],
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": true,
          "expr": "avg(max by (instance) (miner_power_target_w{type=\"configured\",job=\"braiinsos-data\",label=~\"$label\"}) or max by (instance) (miner_power{type=\"limit\",job=\"braiinsos-data\",label=~\"$label\"}))",
          "interval": "",
          "legendFormat": "Avg Power Target",
          "refId": "A"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": true,
          "expr": "max(max by (instance) (miner_power_target_w{type=\"configured\",job=\"braiinsos-data\",label=~\"$label\"}) or max by (instance) (miner_power{type=\"limit\",job=\"braiinsos-data\",label=~\"$label\"}))",
          "hide": false,
          "interval": "",
          "legendFormat": "Max Power Target",
          "refId": "B"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": true,
          "expr": "min(max by (instance) (miner_power_target_w{type=\"configured\",job=\"braiinsos-data\",label=~\"$label\"}) or max by (instance) (miner_power{type=\"limit\",job=\"braiinsos-data\",label=~\"$label\"}))",
          "hide": false,
          "interval": "",
          "legendFormat": "Min Power Target",
          "refId": "C"
        }
      ],
      "title": "Min, Avg, Max Power Target (only BOS+)",
      "type": "timeseries"
    },
    {
      "description": "Estimated power consumption in Watts and power target (only BOS+).",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [
            {
              "options": {
                "match": "null+nan",
                "result": {
                  "index": 0,
                  "text": "N/A"
                }
              },
              "type": "special"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "watt"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 7,
        "w": 12,
        "x": 12,
        "y": 95
      },
      "id": 43,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": true,
          "expr": "sum(miner_power_target_w{type=\"current\",job=\"braiinsos-data\",label=~\"$label\"}) or sum(miner_power{type=\"estimated\",job=\"braiinsos-data\",label=~\"$label\"})",
          "interval": "",
          "legendFormat": "Estimated Power",
          "refId": "A"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": true,
          "expr": "sum(miner_power_target_w{type=\"configured\",job=\"braiinsos-data\",label=~\"$label\"}) or sum(miner_power{type=\"limit\",job=\"braiinsos-data\",label=~\"$label\"})",
          "hide": false,
          "interval": "",
          "legendFormat": "Power Target",
          "refId": "B"
        }
      ],
      "title": "Power Target & Est. Consumption (W)",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 102
      },
      "id": 159,
      "panels": [],
      "title": "Users",
      "type": "row"
    },
    {
      "description": "Hashrate by pool user",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-RdYlGr"
          },
          "displayName": "${__series.name}",
          "links": [
            {
              "targetBlank": true,
              "title": "List of Miners Per User",
              "url": "d/sp8gIgNVz/drill-down-user-instance?var-User=${__series.name}"
            }
          ],
          "mappings": [
            {
              "options": {
                "match": "null+nan",
                "result": {
                  "index": 0,
                  "text": "N/A"
                }
              },
              "type": "special"
            }
          ],
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "semi-dark-purple",
                "value": null
              }
            ]
          },
          "unit": "GHs"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 5,
        "w": 12,
        "x": 0,
        "y": 103
      },
      "id": 161,
      "options": {
        "displayMode": "lcd",
        "orientation": "horizontal",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showUnfilled": true
      },
      "pluginVersion": "8.4.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "sort_desc(sum by (user) (\nsum by(instance,user) (rate(stratum_accepted_shares_counter{connection_type=\"user\"}[$interval])) * 2^32 / 1e9\nor\nsum by (instance,user) (((average_hashrate_last_5_sec_ghs * on(instance) group_right() (client_status{connection_type=\"user\"}==1))))\n))",
          "instant": true,
          "interval": "",
          "legendFormat": "{{user}}",
          "refId": "A"
        }
      ],
      "title": "Hashrate by User",
      "transformations": [
        {
          "id": "renameByRegex",
          "options": {
            "regex": "braiinsos-data",
            "renamePattern": "BOS+"
          }
        },
        {
          "id": "renameByRegex",
          "options": {
            "regex": "metrics-exporter",
            "renamePattern": "Stock FW"
          }
        }
      ],
      "type": "bargauge"
    },
    {
      "description": "Actual no. of devices per user. *BOS+* has a feature to \"slice\" a miner into pool groups, so that it is possible to mine on multiple users in the same time. The miner has to mining.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-BlPu"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "locale"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 5,
        "w": 12,
        "x": 12,
        "y": 103
      },
      "id": 162,
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "value_and_name"
      },
      "pluginVersion": "8.4.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": false,
          "expr": "sort_desc(count by (user) (\nsum by(instance,user) (rate(stratum_accepted_shares_counter{connection_type=\"user\"}[$interval])) * 2^32 / 1e9 > 0\nor\nsum by (instance,user) (((average_hashrate_last_5_sec_ghs * on(instance) group_right() (client_status{connection_type=\"user\"}==1)))) > 0\n))",
          "instant": true,
          "interval": "",
          "legendFormat": "{{user}}",
          "refId": "A"
        }
      ],
      "title": "Actual Number of Mining Devices per User",
      "type": "stat"
    },
    {
      "description": "Hashrate per user, *BOS+* devices are taking into account only accpeted shares. *Stock FW* devices are taking in to account all shares since cgminer API doesn't provide invalid/rejected shares. ",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "GHs"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 108
      },
      "id": 157,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": true,
          "expr": "sum by (user) (\nsum by(instance,user) (rate(stratum_accepted_shares_counter{connection_type=\"user\"}[$interval])) * 2^32 / 1e9\nor\nsum by (instance,user) (((average_hashrate_last_5_sec_ghs * on(instance) group_right() (client_status{connection_type=\"user\"}==1))))\n)",
          "interval": "",
          "legendFormat": "{{user}}",
          "refId": "A"
        }
      ],
      "title": "Hashrate per User",
      "type": "timeseries"
    },
    {
      "description": "No. of devices per user. *BOS+* has a feature to \"slice\" a miner into pool groups, so that it is possible to mine on multiple users at the same time.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "locale"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 108
      },
      "id": 160,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PABF2E7BD7AE7B0F4"
          },
          "exemplar": true,
          "expr": "count by (user) (\nsum by(instance,user) (rate(stratum_accepted_shares_counter{connection_type=\"user\"}[$interval])) * 2^32 / 1e9\nor\nsum by (instance,user) (((average_hashrate_last_5_sec_ghs * on(instance) group_right() (client_status{connection_type=\"user\"}==1))))\n)",
          "interval": "",
          "legendFormat": "{{user}}",
          "refId": "A"
        }
      ],
      "title": "Number of Devices per User",
      "type": "timeseries"
    }
  ],
  "refresh": "1m",
  "schemaVersion": 35,
  "style": "dark",
  "tags": [],
  "templating": {
    "list": [
      {
        "allValue": "",
        "current": {
          "selected": false,
          "text": "All",
          "value": "$__all"
        },
        "definition": "label_values(job)",
        "description": "Firmware - braiinsos-data stands for the BOS+ and metrics-exporter stands for the stock FW",
        "hide": 0,
        "includeAll": true,
        "label": "OS",
        "multi": false,
        "name": "OS",
        "options": [],
        "query": {
          "query": "label_values(job)",
          "refId": "StandardVariableQuery"
        },
        "refresh": 1,
        "regex": "/^(?!.*prometheus$).*$/",
        "skipUrlSync": false,
        "sort": 0,
        "type": "query"
      },
      {
        "current": {
          "selected": false,
          "text": "All",
          "value": "$__all"
        },
        "definition": "label_values(client_status, label)",
        "description": "Name of the IP range. In this example case, the IP range represents building.",
        "hide": 0,
        "includeAll": true,
        "label": "Building",
        "multi": false,
        "name": "label",
        "options": [],
        "query": {
          "query": "label_values(client_status, label)",
          "refId": "StandardVariableQuery"
        },
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "type": "query"
      },
      {
        "current": {
          "selected": false,
          "text": "5m",
          "value": "5m"
        },
        "hide": 0,
        "includeAll": false,
        "label": "Interval",
        "multi": false,
        "name": "interval",
        "options": [
          {
            "selected": false,
            "text": "5m",
            "value": "5m"
          },
          {
            "selected": false,
            "text": "10m",
            "value": "10m"
          },
          {
            "selected": false,
            "text": "15m",
            "value": "15m"
          }
        ],
        "query": "5m,10m,15m",
        "queryValue": "",
        "skipUrlSync": false,
        "type": "custom"
      }
    ]
  },
  "time": {
    "from": "now-6h",
    "to": "now"
  },
  "timepicker": {},
  "timezone": "",
  "title": "Farm Dashboard",
  "uid": "X5qFFjI4z",
  "version": 40,
  "weekStart": ""
}
